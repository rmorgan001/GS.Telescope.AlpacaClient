<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>GSS 3D Model</title>
	<style>
		body, html {
			width: 100%;
			height: 100%;
			margin: 0;
			padding: 0;
			overflow: hidden;
			background-color: #1a1a1a;
		}

		#renderCanvas {
			width: 100%;
			height: 100%;
			display: block;
			touch-action: none;
		}

		#loadingMessage {
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			color: white;
			font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
			font-size: 18px;
			text-align: center;
			z-index: 1000;
			pointer-events: none;
		}

			#loadingMessage.hidden {
				display: none;
			}
	</style>
</head>
<body>
    <div id="loadingMessage">
        <p>🔭 TelescopeViewer</p>
        <p style="font-size: 14px; color: #888;">Initializing ...</p>
    </div>
    <canvas id="renderCanvas"></canvas>

    <script src="babylon.max.js"></script><!-- Babylon.js Core Library -->
    <script src="babylonjs.loaders.min.js"></script><!-- Babylon.js Loaders (OBJ, MTL support) -->
    <script src="viewer.js"></script><!--SampleRotator Viewer Script-->

    <script>
        let viewer;

        function initViewer() {
            // Read texture data from global window variables (set by C#)
            const skyboxBase64 = window.skyboxTextureData || '';
            const compassNorthBase64 = window.compassNorthTextureData || '';
            const compassSouthBase64 = window.compassSouthTextureData || '';
            const primaryHex = window.primaryHexColorData || "#FF0000";;
            const secondaryHex = window.secondaryHexColorData || "#00FF00";;
            const nHemiSphere = window.nHemiSphereData || "true";;

            console.log('Initializing viewer with textures:',
                'primary4Hex:', primaryHex, 'string,',
                'secondary4Hex:', secondaryHex, 'string,',
                'skybox:', skyboxBase64.length, 'bytes,',
                'compassN:', compassNorthBase64.length, 'bytes,',
                'compassS:', compassSouthBase64.length, 'bytes,');

            viewer = new BabylonViewer('renderCanvas', skyboxBase64, compassNorthBase64, compassSouthBase64, primaryHex, secondaryHex, nHemiSphere);
            return 'TelescopeViewer initialized';
        }

        async function loadModel(objBase64, mtlBase64) {
            if (!viewer) {
                return 'Error: Viewer not initialized';
            }
            return await viewer.loadTelescopeModel(objBase64, mtlBase64);
        }

        //function setTelescopeRotation(altitude, rightAscension, declination) {
        //	if (!viewer) {
        //		console.error('Viewer not initialized');
        //		return;
        //	}
        //	viewer.setTelescopeRotation(altitude, rightAscension, declination);
        //}

        function setHemisphere(isNorthern) {
        	if (!viewer) {
        		console.error('Viewer not initialized');
        		return;
        	}
        	viewer.setHemisphere(isNorthern);
        }
    </script>
</body>
</html>
